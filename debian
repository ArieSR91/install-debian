apt update && apt upgrade -y && apt install mc proot-distro pulseaudio -y && proot-distro install debian
echo "load-module module-native-protocol-tcp auth-ip-acl=127.0.0.1 auth-anonymous=1" >> ../usr/etc/pulse/default.pa
echo "clear
pulseaudio --start --exit-idle-time=-1
## uncomment the command below if you want to login as user
# proot-distro login --user (username) debian
proot-distro login debian

alias ll='ls -l'
alias la='ls -A'
alias l='ls -CF'
alias c='clear'
alias x='exit'
alias cl='clear'
alias clr='clear'
alias cls='clear'
alias nn='nano'
alias nf='neofetch'
alias py2='python2'
alias py3='python3'
" >> $HOME/.bashrc
echo "#!/usr/bin/env bash
# by ArieSR91

export USER=root
export HOME=/root
# export USER=(username)
# export HOME=/home/(username)

function stop-vnc() {
    vncserver -kill :1
    vncserver -kill :2
    rm -rf /root/.vnc/localhost:1.pid
    rm -rf /home/ArieSR91/.vnc/localhost:1.pid
    rm -rf /tmp/.X1-lock
    rm -rf /tmp/.X11-unix/X1
    return 0
}
function start-vnc() {
    vncserver -kill :1
    vncserver -kill :2
    rm -rf /root/.vnc/localhost:1.pid
    rm -rf /home/ArieSR91/.vnc/localhost:1.pid
    rm -rf /tmp/.X1-lock
    rm -rf /tmp/.X11-unix/X1
    vncserver -geometry 1508x720
    sessions=$(vncserver -list | sed s/'TigerVNC'/'Kali Linux'/)
    if [[ $sessions == *'590'* ]]; then
        printf '\n${sessions}\n'
        printf '\nYou can use the bVNC for login to GUI.\n\n'
    fi
    return 0
}

case $1 in
    start)
        start-vnc
        ;;
    stop)
        stop-vnc
        ;;
esac " >> /usr/local/bin/vnc
chmod +x /usr/local/bin/vnc
echo "apt-mark hold udisks2
apt update && apt upgrade -y
apt install wget gnupg nano -y
wget -q -O - https://archive.kali.org/archive-key.asc | apt-key add
rm /etc/apt/sources.list
echo '#Kali Repositoty
deb http://http.kali.org/kali kali-rolling main non-free contrib
deb-src http://http.kali.org/kali kali-rolling main non-free contrib
# deb http://deb.debian.org/debian bullseye main contrib
# deb http://deb.debian.org/debian bullseye-updates main contrib
# deb http://security.debian.org/debian-security bullseye-security main contrib' >> /etc/apt/sources.list
apt update && apt dist-upgrade -y
apt-mark hold udisks2
mkdir .vnc
wget https://raw.githubusercontent.com/ArieSR91/install-debian/main/xstartup
mv xstartup ~/.vnc
apt install gvfs gvfs-common gvfs-daemons gvfs-libs sudo mc
" >> ../usr/var/lib/proot-distro/installed-rootfs/debian/root/install-kali
pulseaudio --start --exit-idle-time=-1
wget https://raw.githubusercontent.com/ArieSR91/termux-kali-dark-style/main/user91
chmod +x user91
./user91
rm user91
rm debian
ln -s  ../usr/var/lib/proot-distro/installed-rootfs/debian
clear
proot-distro login debian
